<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:NiziKit.Editor.ViewModels"
             xmlns:views="using:NiziKit.Editor.Views"
             xmlns:ui="using:FluentAvalonia.UI.Controls"
             x:Class="NiziKit.Editor.Views.ImportPanel"
             x:DataType="vm:ImportViewModel">

    <Grid RowDefinitions="*,Auto,Auto" Margin="16">
        <Border Grid.Row="0"
                Background="{StaticResource EditorSurfaceRaised}"
                BorderBrush="{StaticResource EditorPanelBorder}"
                BorderThickness="1"
                Padding="12"
                Margin="0,0,0,12">
            <views:FileBrowserGrid DataContext="{Binding FileBrowser}"/>
        </Border>

        <Border Grid.Row="1"
                Background="{StaticResource EditorSurfaceRaised}"
                BorderBrush="{StaticResource EditorPanelBorder}"
                BorderThickness="1"
                Padding="18,14"
                Margin="0,0,0,12">
            <Grid ColumnDefinitions="Auto,Auto,Auto,Auto,Auto,*" RowDefinitions="Auto">
                <TextBlock Text="Type"
                           VerticalAlignment="Center"
                           Foreground="{StaticResource EditorTextSecondary}"
                           Margin="0,0,16,0"/>
                <StackPanel Grid.Column="1"
                            Orientation="Horizontal"
                            Spacing="20"
                            Margin="0,0,32,0">
                    <RadioButton Content="Models"
                                 IsChecked="{Binding ImportType, Converter={x:Static vm:ImportTypeConverter.Instance}, ConverterParameter={x:Static vm:ImportType.Models}}"
                                 GroupName="ImportType"/>
                    <RadioButton Content="Textures"
                                 IsChecked="{Binding ImportType, Converter={x:Static vm:ImportTypeConverter.Instance}, ConverterParameter={x:Static vm:ImportType.Textures}}"
                                 GroupName="ImportType"/>
                    <RadioButton Content="Both"
                                 IsChecked="{Binding ImportType, Converter={x:Static vm:ImportTypeConverter.Instance}, ConverterParameter={x:Static vm:ImportType.Both}}"
                                 GroupName="ImportType"/>
                </StackPanel>

                <TextBlock Grid.Column="2"
                           Text="Scale"
                           VerticalAlignment="Center"
                           Foreground="{StaticResource EditorTextSecondary}"
                           Margin="0,0,12,0"/>
                <TextBox Grid.Column="3"
                         Text="{Binding ModelScale}"
                         Width="90"
                         Margin="0,0,32,0"/>

                <CheckBox Grid.Column="4"
                          Content="Generate Mipmaps"
                          IsChecked="{Binding GenerateMips}"
                          VerticalAlignment="Center"/>
            </Grid>
        </Border>

        <Border Grid.Row="2"
                Background="{StaticResource EditorPanelSecondaryBackground}"
                Padding="18,14">
            <Grid ColumnDefinitions="Auto,*,Auto,Auto,Auto">
                <TextBlock Text="Output"
                           VerticalAlignment="Center"
                           Foreground="{StaticResource EditorTextSecondary}"
                           Margin="0,0,16,0"/>
                <TextBox Grid.Column="1"
                         Text="{Binding OutputDirectory}"
                         Watermark="Assets/..."
                         VerticalAlignment="Center"/>

                <StackPanel Grid.Column="2"
                            Orientation="Horizontal"
                            VerticalAlignment="Center"
                            Spacing="14"
                            Margin="20,0"
                            IsVisible="{Binding IsImporting}">
                    <TextBlock Text="{Binding ProgressText}"
                               VerticalAlignment="Center"
                               MaxWidth="220"
                               TextTrimming="CharacterEllipsis"
                               Foreground="{StaticResource EditorTextSecondary}"/>
                    <ProgressBar Value="{Binding Progress}"
                                 Maximum="100"
                                 Width="120"
                                 Height="6"
                                 VerticalAlignment="Center"/>
                </StackPanel>

                <Button Grid.Column="3"
                        Content="Cancel"
                        Command="{Binding CancelCommand}"
                        Margin="12,0"
                        MinWidth="110"
                        Padding="18,12"/>
                <Button Grid.Column="4"
                        Content="Import"
                        Command="{Binding ImportCommand}"
                        IsEnabled="{Binding !IsImporting}"
                        MinWidth="110"
                        Padding="18,12"
                        Classes="accent"/>
            </Grid>
        </Border>
    </Grid>
</UserControl>
